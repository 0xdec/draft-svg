{"version":3,"sources":["draft-svg.js"],"names":["NS","VERSION","mixin","renderSVG","width","height","create","element","type","svg","document","createElementNS","dom","calcX","Draft","px","prop","calcY","svgRoot","this","setAttribute","domID","undefined","join","recursive","obj","func","key","Array","Doc","View","Element","listener","parent","appendChild","val","target","apply","radius","on","Page"],"mappings":"AAAA,cAUA,WACE,GAAMA,GAAK,6BAGLC,EAAU,MAEZC,GAEFC,UAAS,SAACC,EAAOC,GACf,GAAIC,GAAS,SAASC,EAASC,GAC7B,GAAIC,GAAMC,SAASC,gBAAgBX,EAAIQ,EAEvC,OADAD,GAAQK,IAAIH,IAAMA,EACXA,GAGLI,EAAQ,SAASN,GACnB,MAAOO,OAAMC,GAAGR,EAAQS,KAAK,MAAQF,MAAMC,GAAGR,EAAQH,SAAW,GAG/Da,EAAQ,SAASV,GACnB,OAAQO,MAAMC,GAAGR,EAAQS,KAAK,MAAQF,MAAMC,GAAGR,EAAQF,UAAY,GAGjEa,EAAUZ,EAAOa,KAAM,MAC3BD,GAAQE,aAAa,QAASpB,GAC9BkB,EAAQE,aAAa,UAAWnB,GAASiB,EAGjCE,aAAa,KAAMD,KAAKE,OAChCH,EAAQE,aAAa,QAAShB,GACfkB,SAAXjB,GACFa,EAAQE,aAAa,SAAUf,GAChCa,EAGOE,aAAa,WACnBP,EAAMM,MAAOF,EAAME,MACnBL,MAAMC,GAAGI,KAAKf,SAAUU,MAAMC,GAAGI,KAAKd,WACtCkB,KAAK,KAAM,IAGTC,GAAY,QAAZA,GAAqBC,EAAKC,GAC5B,IAAK,GAAIC,KAAOF,GACdD,EAAUC,EAAIE,YAAgBC,OAC5BH,EAAIE,GAAOD,EAAKD,EAAKE,GAAMD,GAmEjC,OA/DAF,GAAUL,KAAM,SAASM,EAAKE,GAC5B,GAAY,WAARA,GACFF,EAAIE,YAAgBb,OAAMe,KAC1BJ,EAAIE,YAAgBb,OAAMgB,KAC1B,OAAO,CACF,IAAIL,EAAIE,YAAgBb,OAAMiB,QAAS,CAG5C,GACIC,GADAxB,EAAOiB,EAAIE,GAAKnB,KAIhBC,EAAMH,EAAOmB,EAAIE,GAAMnB,EA+C3B,OA9CAiB,GAAIE,GAAKM,OAAOrB,IAAIH,IAAIyB,YAAYzB,GACpCA,EAAIW,aAAa,eAAgB,GACjCX,EAAIW,aAAa,SAAU,QAGd,SAATZ,GACFwB,EAAW,SAAShB,EAAMmB,GACxBA,EAAMrB,MAAMC,GAAGoB,GAEF,UAATnB,EACFP,EAAIW,aAAa,QAASN,MAAMC,GAAGoB,IACjB,WAATnB,GACTP,EAAIW,aAAa,SAAUN,MAAMC,GAAGoB,IAGzB,MAATnB,GAAyB,UAATA,EAClBP,EAAIW,aAAa,IAAKP,EAAMM,KAAKiB,UACf,MAATpB,GAAyB,WAATA,IACzBP,EAAIW,aAAa,IAAKH,EAAME,KAAKiB,UAKrCJ,EAASK,OAAOD,OAAQX,EAAIE,KAAQ,QAASF,EAAIE,GAAKvB,UACtD4B,EAASK,OAAOD,OAAQX,EAAIE,KAAQ,SAAUF,EAAIE,GAAKtB,WACvD2B,EAASK,OAAOD,OAAQX,EAAIE,KAAQ,IAAKF,EAAIE,GAAKX,KAAK,OACvDgB,EAASK,OAAOD,OAAQX,EAAIE,KAAQ,IAAKF,EAAIE,GAAKX,KAAK,QAErC,WAATR,IACTwB,EAAW,SAAShB,EAAMmB,GACxBA,EAAMrB,MAAMC,GAAGoB,GAEF,MAATnB,EACFP,EAAIW,aAAa,IAAKe,GACJ,MAATnB,EACTP,EAAIW,aAAa,KAAMN,MAAMC,GAAGoB,IACd,MAATnB,GACTP,EAAIW,aAAa,MAAON,MAAMC,GAAGoB,MAI5B,IAAKV,EAAIE,GAAKW,UAGzBb,EAAIE,GAAKY,GAAG,SAAUP,GAEfP,EAAIE,MAIRT,GAIXJ,OAAM0B,KAAKtC,MAAMA,GACjBY,MAAMgB,KAAK5B,MAAMA","file":"draft-svg.min.js","sourcesContent":["/*\n* draft-svg - A plugin for draft.js that renders drafts using SVG\n* version v0.0.0\n* https://github.com/D1SC0tech/draft-svg\n*\n* copyright Jordi Pakey-Rodriguez <jordi.orlando@gmail.com>\n* license MIT\n*\n* BUILT: Thu Jan 14 2016 04:09:53 GMT-0600 (CST)\n*/\n(function() {\n  const NS = 'http://www.w3.org/2000/svg';\n  // const XMLNS = 'http://www.w3.org/2000/xmlns/';\n  // const XLINK = 'http://www.w3.org/1999/xlink';\n  const VERSION = '1.1';\n\n  var mixin = {\n    // TODO: add elements to SVG dom as they are created in js\n    renderSVG(width, height) {\n      var create = function(element, type) {\n        var svg = document.createElementNS(NS, type);\n        element.dom.svg = svg;\n        return svg;\n      };\n\n      var calcX = function(element) {\n        return Draft.px(element.prop('x')) - Draft.px(element.width()) / 2;\n      };\n\n      var calcY = function(element) {\n        return -Draft.px(element.prop('y')) - Draft.px(element.height()) / 2;\n      };\n\n      var svgRoot = create(this, 'svg');\n      svgRoot.setAttribute('xmlns', NS);\n      svgRoot.setAttribute('version', VERSION);\n      // svgRoot.setAttributeNS(XMLNS, 'xmlns:xlink', XLINK);\n\n      svgRoot.setAttribute('id', this.domID);\n      svgRoot.setAttribute('width', width);\n      if (height !== undefined) {\n        svgRoot.setAttribute('height', height);\n      }\n\n      // 1 SVG user unit = 1px\n      svgRoot.setAttribute('viewBox', [\n        calcX(this), calcY(this),\n        Draft.px(this.width()), Draft.px(this.height())\n      ].join(' '));\n\n      // TODO: move this to draft.js\n      var recursive = function(obj, func) {\n        for (var key in obj) {\n          recursive(obj[key] instanceof Array ?\n            obj[key] : func(obj, key), func);\n        }\n      };\n\n      recursive(this, function(obj, key) {\n        if (key === 'parent' ||\n          obj[key] instanceof Draft.Doc ||\n          obj[key] instanceof Draft.View) {\n          return false;\n        } else if (obj[key] instanceof Draft.Element) {\n          // console.info('rendering:', obj[key].prop());\n\n          var type = obj[key].type;\n          var listener;\n\n          // TODO: modularize svg creation\n          var svg = create(obj[key], type);\n          obj[key].parent.dom.svg.appendChild(svg);\n          svg.setAttribute('fill-opacity', 0);\n          svg.setAttribute('stroke', '#000');\n\n          // TODO: separate listener for each property?\n          if (type === 'rect') {\n            listener = function(prop, val) {\n              val = Draft.px(val);\n\n              if (prop === 'width') {\n                svg.setAttribute('width', Draft.px(val));\n              } else if (prop === 'height') {\n                svg.setAttribute('height', Draft.px(val));\n              }\n\n              if (prop === 'x' || prop === 'width') {\n                svg.setAttribute('x', calcX(this.target));\n              } else if (prop === 'y' || prop === 'height') {\n                svg.setAttribute('y', calcY(this.target));\n              }\n              // svg.setAttribute('x', );\n            };\n\n            listener.apply({target: obj[key]}, ['width', obj[key].width()]);\n            listener.apply({target: obj[key]}, ['height', obj[key].height()]);\n            listener.apply({target: obj[key]}, ['x', obj[key].prop('x')]);\n            listener.apply({target: obj[key]}, ['y', obj[key].prop('y')]);\n            // svg.setAttribute('x', );\n          } else if (type === 'circle') {\n            listener = function(prop, val) {\n              val = Draft.px(val);\n\n              if (prop === 'r') {\n                svg.setAttribute('r', val);\n              } else if (prop === 'x') {\n                svg.setAttribute('cx', Draft.px(val));\n              } else if (prop === 'y') {\n                svg.setAttribute('cy', -Draft.px(val));\n              }\n            };\n\n            listener('r', obj[key].radius());\n          }\n\n          obj[key].on('change', listener);\n\n          return obj[key];\n        }\n      });\n\n      return svgRoot;\n    }\n  };\n\n  Draft.Page.mixin(mixin);\n  Draft.View.mixin(mixin);\n})();\n"],"sourceRoot":"/source/"}