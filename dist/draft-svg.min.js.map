{"version":3,"sources":["draft-svg.js"],"names":["recursive","obj","func","key","Array","NS","VERSION","svg","renderSVG","width","height","create","element","type","document","createElementNS","dom","calcX","Draft","px","prop","calcY","this","setAttribute","domID","join","Doc","View","Element","console","info","listener","parent","appendChild","val","target","apply","radius","on","Page","mixin"],"mappings":"AAAA,cAUA,WAIwB,QAGbA,GAAUC,EAAKC,GACtB,IAAK,GAAIC,KAAOF,GACdD,EAAUC,EAAIE,YAAgBC,OAC5BH,EAAIE,GAAOD,EAAKD,EAAKE,GAAMD,GATjC,GAAMG,GAAK,6BAGLC,EAAU,MAUZC,GAEFC,UAAW,SAASC,EAAOC,GACzB,GAAIC,GAAS,SAASC,EAASC,GAC7B,GAAIN,GAAMO,SAASC,gBAAgBV,EAAIQ,EAEvC,OADAD,GAAQI,IAAIT,IAAMA,EACXA,GAGLU,EAAQ,SAASL,GACnB,MAAOM,OAAMC,GAAGP,EAAQQ,KAAK,MAAQF,MAAMC,GAAGP,EAAQH,SAAW,GAG/DY,EAAQ,SAAST,GACnB,OAAQM,MAAMC,GAAGP,EAAQQ,KAAK,MAAQF,MAAMC,GAAGP,EAAQF,UAAY,GAGjEH,EAAMI,EAAOW,KAAM,MA8EvB,OA7EAf,GAAIgB,aAAa,QAASlB,GAC1BE,EAAIgB,aAAa,UAAWjB,GAASC,EAGjCgB,aAAa,KAAML,MAAMM,MAAMF,OACnCf,EAAIgB,aAAa,QAASd,GAAOF,EAI7BgB,aAAa,WACfN,EAAMK,MAAOD,EAAMC,MACnBJ,MAAMC,GAAGG,KAAKb,SAAUS,MAAMC,GAAGG,KAAKZ,WACtCe,KAAK,MAEPzB,EAAUsB,KAAM,SAASrB,EAAKE,GAC5B,GAAW,UAAPA,GAAmBF,EAAIE,YAAgBe,OAAMQ,KAAOzB,EAAIE,YAAgBe,OAAMS,KAChF,OAAO,CACF,IAAI1B,EAAIE,YAAgBe,OAAMU,QAAS,CAC5CC,QAAQC,KAAK,aAAc7B,EAAIE,GAAKiB,OAEpC,IACIW,GADAlB,EAAOZ,EAAIE,GAAKiB,KAAK,QAIrBb,EAAMI,EAAOV,EAAIE,GAAMU,EA+C3B,OA9CAZ,GAAIE,GAAK6B,OAAOhB,IAAIT,IAAI0B,YAAY1B,GACpCA,EAAIgB,aAAa,eAAgB,GACjChB,EAAIgB,aAAa,SAAU,QAGf,QAARV,GACFkB,EAAW,SAASX,EAAMc,GACxBA,EAAMhB,MAAMC,GAAGe,GAEH,SAARd,EACFb,EAAIgB,aAAa,QAASL,MAAMC,GAAGe,IAClB,UAARd,GACTb,EAAIgB,aAAa,SAAUL,MAAMC,GAAGe,IAG1B,KAARd,GAAuB,SAARA,EACjBb,EAAIgB,aAAa,IAAKN,EAAMK,KAAKa,UAChB,KAARf,GAAuB,UAARA,IACxBb,EAAIgB,aAAa,IAAKF,EAAMC,KAAKa,UAKrCJ,EAASK,OAAOD,OAAQlC,EAAIE,KAAQ,QAASF,EAAIE,GAAKM,UACtDsB,EAASK,OAAOD,OAAQlC,EAAIE,KAAQ,SAAUF,EAAIE,GAAKO,WACvDqB,EAASK,OAAOD,OAAQlC,EAAIE,KAAQ,IAAKF,EAAIE,GAAKiB,KAAK,OACvDW,EAASK,OAAOD,OAAQlC,EAAIE,KAAQ,IAAKF,EAAIE,GAAKiB,KAAK,QAEtC,UAARP,IACTkB,EAAW,SAASX,EAAMc,GACxBA,EAAMhB,MAAMC,GAAGe,GAEH,KAARd,EACFb,EAAIgB,aAAa,IAAKW,GACL,KAARd,EACTb,EAAIgB,aAAa,KAAML,MAAMC,GAAGe,IACf,KAARd,GACTb,EAAIgB,aAAa,MAAOL,MAAMC,GAAGe,MAI5B,IAAKjC,EAAIE,GAAKkC,UAGzBpC,EAAIE,GAAKmC,GAAG,SAAUP,GAEf9B,EAAIE,MAMRI,GAIXW,OAAMqB,KAAKC,MAAMjC,GACjBW,MAAMS,KAAKa,MAAMjC","file":"draft-svg.min.js","sourcesContent":["/*\n* draft-svg - A plugin for draft.js that renders drafts using SVG\n* version v0.0.0\n* https://github.com/D1SC0tech/draft-svg\n*\n* copyright Jordi Pakey-Rodriguez <jordi.orlando@gmail.com>\n* license MIT\n*\n* BUILT: Mon Jan 11 2016 21:46:19 GMT-0600 (CST)\n*/\n(function() {\n  const NS = 'http://www.w3.org/2000/svg';\n  const XMLNS = 'http://www.w3.org/2000/xmlns/';\n  const XLINK = 'http://www.w3.org/1999/xlink';\n  const VERSION = '1.1';\n\n  // TODO: move this to draft.js\n  function recursive(obj, func) {\n    for (let key in obj) {\n      recursive(obj[key] instanceof Array ?\n        obj[key] : func(obj, key), func);\n    }\n  }\n\n  var svg = {\n    // TODO: add elements to SVG dom as they are created in js\n    renderSVG: function(width, height) {\n      var create = function(element, type) {\n        var svg = document.createElementNS(NS, type);\n        element.dom.svg = svg;\n        return svg;\n      };\n\n      var calcX = function(element) {\n        return Draft.px(element.prop('x')) - Draft.px(element.width()) / 2;\n      };\n\n      var calcY = function(element) {\n        return -Draft.px(element.prop('y')) - Draft.px(element.height()) / 2;\n      };\n\n      var svg = create(this, 'svg');\n      svg.setAttribute('xmlns', NS);\n      svg.setAttribute('version', VERSION);\n      // svg.setAttributeNS(XMLNS, 'xmlns:xlink', XLINK);\n\n      svg.setAttribute('id', Draft.domID(this));\n      svg.setAttribute('width', width);\n      // svg.setAttribute('max-height', height);\n\n      // 1 SVG user unit = 1px\n      svg.setAttribute('viewBox', [\n        calcX(this), calcY(this),\n        Draft.px(this.width()), Draft.px(this.height())\n      ].join(' '));\n\n      recursive(this, function(obj, key) {\n        if (key == 'parent' || obj[key] instanceof Draft.Doc || obj[key] instanceof Draft.View) {\n          return false;\n        } else if (obj[key] instanceof Draft.Element) {\n          console.info('rendering:', obj[key].prop());\n\n          var type = obj[key].prop('type');\n          var listener;\n\n          // TODO: modularize svg creation\n          var svg = create(obj[key], type);\n          obj[key].parent.dom.svg.appendChild(svg);\n          svg.setAttribute('fill-opacity', 0);\n          svg.setAttribute('stroke', '#000');\n\n          // TODO: separate listener for each property?\n          if (type == 'rect') {\n            listener = function(prop, val) {\n              val = Draft.px(val);\n\n              if (prop == 'width') {\n                svg.setAttribute('width', Draft.px(val));\n              } else if (prop == 'height') {\n                svg.setAttribute('height', Draft.px(val));\n              }\n\n              if (prop == 'x' || prop == 'width') {\n                svg.setAttribute('x', calcX(this.target));\n              } else if (prop == 'y' || prop == 'height') {\n                svg.setAttribute('y', calcY(this.target));\n              }\n              // svg.setAttribute('x', );\n            };\n\n            listener.apply({target: obj[key]}, ['width', obj[key].width()]);\n            listener.apply({target: obj[key]}, ['height', obj[key].height()]);\n            listener.apply({target: obj[key]}, ['x', obj[key].prop('x')]);\n            listener.apply({target: obj[key]}, ['y', obj[key].prop('y')]);\n            // svg.setAttribute('x', );\n          } else if (type == 'circle') {\n            listener = function(prop, val) {\n              val = Draft.px(val);\n\n              if (prop == 'r') {\n                svg.setAttribute('r', val);\n              } else if (prop == 'x') {\n                svg.setAttribute('cx', Draft.px(val));\n              } else if (prop == 'y') {\n                svg.setAttribute('cy', -Draft.px(val));\n              }\n            };\n\n            listener('r', obj[key].radius());\n          }\n\n          obj[key].on('change', listener);\n\n          return obj[key];\n        } else {\n          return undefined;\n        }\n      });\n\n      return svg;\n    }\n  };\n\n  Draft.Page.mixin(svg);\n  Draft.View.mixin(svg);\n})();\n"],"sourceRoot":"/source/"}